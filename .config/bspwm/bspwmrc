#!/usr/bin/env bash
#
#   _   _          ____                   __ _
#  | | | |        |___ \                 / _(_)
#  | |_| |__   ___  __) | ___ ___  _ __ | |_ _  __ _
#  | __| '_ \ / _ \|__ < / __/ _ \| '_ \|  _| |/ _` |
#  | |_| | | |  __/___) | (_| (_) | | | | | | | (_| |
#   \__|_| |_|\___|____/ \___\___/|_| |_|_| |_|\__, |
#                                               __/ |
#                                              |___/


config() {

   bspc config focused_border_color "$color4"
   bspc config border_width         2
   bspc config split_ratio          0.5
   bspc config gapless_monocle true
   bspc config left_padding 0
   bspc config right_padding 0

   bspc monitor -d 1 2 3 4 5 6 7 8 9 10

   exec xmodmap -e "keycode 135 = Super_R" &

}


apps() {

   ukill "dunstbar --boot"
   ukill autogap
   pkill compton

   if [[ -z $(pgrep lemonbar) ]]; then

      dunstbar --boot & disown
      autogap & disown
      compton --dbus -b & disown

   else
      ukill runbar && runbar & disown
   fi

   pkill dunst &&
      dunst & disown

   ukill acpid_events &&
      acpid_events & disown

   killall xbanish &&
      xbanish -i Mod1 -i Mod4 & disown

}


rules() {

   bspc rule -r Zathura
   bspc rule -a Zathura state=tiled

   bspc rule -r float
   bspc rule -a float sticky=off state=floating 

   bspc rule -r files
   bspc rule -a files locked=on sticky=on state=floating hidden=on

   bspc rule -r scratchterm
   bspc rule -a scratchterm locked=on sticky=on state=floating hidden=on

   bspc rule -r scratchmath
   bspc rule -a scratchmath locked=on sticky=on state=floating hidden=on

}


colors() {

   source /home/ringdal/.cache/wal/colors.sh

   ln -sf "$HOME/.cache/wal/dunstrc" "$HOME/.config/dunst/dunstrc" &
   ln -sf "$HOME/.cache/wal/zathurarc" "$HOME/.config/zathura/zathurarc" &

   sed 's/{color4}/'$color4'/p;s/{color7}/'$color7'/g;s/{color0}/'$color0'/g'\
      $HOME/.config/wal/qute >\
      $HOME/.config/qutebrowser/config.py

   [[ ! -z $(pgrep -x qutebrowser) ]] && qutebrowser :config-source

}


main() {

   colors
   config
   rules
   apps

}

main
