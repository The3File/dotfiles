#!/usr/bin/env bash

sig(){
   if [[ $inf = "enp0s25" ]]; then
      icon=''
   elif [[ $inf = "wlp3s0" ]]; then
      signal=$(iwlist wlp3s0 scan | sed -n '5P' | awk -F'=' '{print $3}' | awk -F' ' '{print $1}')
      #直
      ((signal >= -30)) && icon=" ****"
      ((signal <= -30)) && icon=" ***"
      ((signal <= -60)) && icon=" **"
      ((signal <= -80)) && icon=" *"
   fi
}

stat(){
   case $status in
      no-carrier) name="$status" ;;
      routable) name=$(iwgetid -r); sig ;;
      *) name="$status"
   esac
}

main(){
   status="$(networkctl status | grep State: | awk '{print $3}')" || status="?"
   inf="$(networkctl status | grep Address |
      sed -n 's/Address://g;s/  *//g; s/on/ /g; P; Q' | awk '{print $2}')"

   stat; printf '%s\n' "$name$icon"
}

main
