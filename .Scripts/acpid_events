#!/usr/bin/env bash

handler(){
   case "$1" in
      button/power) [[ $2 = "PBTN" ]] && "$HOME/.Scripts/byebye" ;;
      ac_adapter)
	    [[ $2 = *ACPI* ]] && { sleep .1; dunstbar; } ;;
   esac
}

main(){
   coproc acpi_listen
   trap 'kill $COPROC_PID' EXIT

   while read -u "${COPROC[0]}" -a event; do
      handler "${event[@]}"
   done
}

main
